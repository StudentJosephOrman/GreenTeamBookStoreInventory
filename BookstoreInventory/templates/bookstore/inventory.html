{% extends 'bookstore/base.html' %}
{% load static %}


{% block metadata %}
<title>Bookstore Manager | Inventory</title>
<link rel="stylesheet" href="{% static 'css/bookstore/inventory.css' %}?={% now 'U' %}">
{% endblock %}

{% block content %}
<div id="search-section">
	<div id="filters">Filters</div>
	<form id="search" method="POST" action="">
		Search
	</form>
</div>
<div id="results-container">
	<div id="books-list">
		{% for book in books %}
			<div class="book-item" onmouseover="on_book_hover(event)">
				<!-- {{book.isbn}} | {{book.name}} -->
			</div>
		{% endfor %}
	</div>
	<div id="details-container">
		<h2>Details</h2>
		<div id="details-container-inner">
			<btn id="edit-selected-book">Edit</btn>
			<div id="details-header">
				<h2 id="selected-book-title">Selected book title</h2>
				<h3 id="selected-book-genre">Genre</h3>
			</div>
			<div class="horizontal-line"></div>
			<div id="details">
				<div class="detail-block">
					<i>Summary:</i>
					<p id="selected-book-summary"></p>
				</div>
				<div class="detail-block">
					<i>Author(s):</i>
					<p id="selected-book-authors"></p>
				</div>
				<div class="detail-inline">
					<i>Quantity(s):</i>
					<p id="selected-book-quantity"></p>
				</div>
				<div class="detail-inline">
					<i>Cost:</i>
					<p id="selected-book-cost"></p>
				</div>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block scripts %}
<!-- <script src="{% static 'js/bookstore/inventory.js' %}"></script> -->
<script>
	function update_details_card(summary, authors, quantity, cost){
    var details_card = document.getElementById('id');

    if(details_card){
        document.getElementById('selected-book-summary').innerText = summary;
        document.getElementById('selected-book-authors').innerText = authors;
        document.getElementById('selected-book-summary').innerText = summary;
        document.getElementById('selected-book-summary').innerText = summary;
    }
	}

	// On book hover in book list
	// Fetch book data and update details card
	async function on_book_hover(event){
		if(event.target){
			var info = event.target.innerText.split(' | ');
			const isbn = info[0];
			const name = info[1];
			
			const response = await fetch(window.location.origin+`api/books/${isbn}/`);
			const data = response.json();

			if(data){
				console.log(data)
			}
		}
	}

	function search_books(query){
		console.log(window.location.origin+`/api/books/search/?query=${query}`);
		fetch(`/api/books/search/${query}`, {
			method: 'GET',
		}).n
	}

	search_books("2412142")
</script>
{% endblock %}